
<!doctype html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Domowa Biblioteka</title>
</head>
<body>
    <h1>Domowa Biblioteka</h1>

    <h2>Dodaj książkę</h2>
    <form id="bookForm">
        <label>Tytuł: <input type="text" name="title" required></label><br>
        <label>Autor: <input type="text" name="author" required></label><br>
        <label>Rok wydania: <input type="number" name="year" required></label><br>
        <label>Liczba stron: <input type="number" name="pages" required></label><br>
        <label>Opis: <textarea name="description"></textarea></label><br>
        <button type="submit">Dodaj książkę</button>
    </form>

    <h2>Lista książek</h2>
    <ul id="booksList"></ul>

    <script>
        async function loadBooks() {
            const res = await fetch('/api/books');
            const books = await res.json();
            const list = document.getElementById('booksList');
            list.innerHTML = '';
            books.forEach(book => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${book.title}</strong> - ${book.author} (${book.year}) | ${book.pages}
                    <button onclick="deleteBook(${book.id})">Usuń</button>`;
                list.appendChild(li);
            });
        }

        async function deleteBook(id) {
            await fetch(`/api/books/${id}`, { method: 'DELETE' });
            loadBooks();
        }

        document.getElementById('bookForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            data.year = parseInt(data.year);
            data.pages = parseInt(data.pages);
            await fetch('/api/books', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            e.target.reset();
            loadBooks();
        });

        loadBooks();
    </script>
</body>
</html>

